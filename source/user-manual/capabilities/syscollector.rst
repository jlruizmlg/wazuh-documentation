.. Copyright (C) 2018 Wazuh, Inc.

.. _syscollector:

System inventory
================

The Wazuh agents are able to collect interesting system information and store it into a DB for each agent on the manager side. The `Syscollector` module is in charge of this collection.

- `Available scans`_
    - Hardware
    - Operating System
    - Network interfaces
    - Packages
    - Ports
    - Processes
- `Compatibility matrix`_
- `How it works`_
- `Use case: Visualize system inventory in the Wazuh App`_

Available scans
---------------

The collected information from Wazuh agents are stored in different SQLite tables. Here is described the content of each available table.

Hardware
^^^^^^^^

 Retrieve basic information about the Hardware components of a system.

+--------------+---------------------+-------------------------------------------+-----------+
| Field        | Description         | Example                                   | Available |
+==============+=====================+===========================================+===========+
| scan_id      | Scan identifier     | 573872577                                 |
+--------------+---------------------+-------------------------------------------+-----------+
| scan_time    | Scan date           | 2018/07/31 15:31:26                       |
+--------------+---------------------+-------------------------------------------+-----------+
| board_serial | Serial number       | NKP670HSGM07E00474                        |
+--------------+---------------------+-------------------------------------------+-----------+
| cpu_name     | Cpu name            | Intel(R) Core(TM) i7-7700HQ CPU @ 2.80GHz |
+--------------+---------------------+-------------------------------------------+-----------+
| cpu_cores    | Number of cpu's     | 4                                         |
+--------------+---------------------+-------------------------------------------+-----------+
| cpu_mhz      | Processor frequency | 900.106                                   |
+--------------+---------------------+-------------------------------------------+-----------+
| ram_total    | Total RAM           | 16374572                                  |
+--------------+---------------------+-------------------------------------------+-----------+
| ram_free     | Free RAM            | 2111928                                   |
+--------------+---------------------+-------------------------------------------+-----------+

 - `Operating system`

 Retrieve basic information about the Operating System.

+--------------+-------------------------+-----------------------------------------------------+-----------+
| Field        | Description             | Example                                             | Available |
+==============+=========================+=====================================================+===========+
| scan_id      | Scan identifier         | 468455719                                           |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| scan_time    | Scan date               | 2018/07/31 15:31:26                                 |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| hostname     | Network hostname        | wazuh-manager                                       |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| architecture | OS arquitecture         | x86_64                                              |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_name      | OS name                 | Ubuntu                                              |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_version   | OS version              | 16.04.5 LTS (Xenial Xerus)                          |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_codename  | OS version codename     | Xenial Xerus                                        |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_major     | Major release version   | 16                                                  |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_minor     | Minor release version   | 04                                                  |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_build     | Optional build-specific |                                                     |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| os_platform  | OS platform             | ubuntu                                              |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| sysname      | System name             | Linux                                               |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| release      | Release name            | 4.15.0-29-generic                                   |
+--------------+-------------------------+-----------------------------------------------------+-----------+
| version      | Release version name    | #31~16.04.1-Ubuntu SMP Wed Jul 18 08:54:04 UTC 2018 |
+--------------+-------------------------+-----------------------------------------------------+-----------+


 - `Network`

 Retrieve information about the existing network interface of a system (up and down interfaces) as well as their routing configuration.

+--------------+---------------------------+-----------------------------------------------------+-----------+
| Field        | Description               | Example                                             | Available
+==============+===========================+=====================================================+===========+
| id           | Id                        | 1                                                   |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| scan_id      | Scan identifier           | 160615720                                           |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| scan_time    | Scan date                 | 2018/07/31 16:46:20                                 |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| name         | Interface name            | eth0                                                |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| adapter      | Physical adapter name     | Intel(R) PRO/1000 MT Desktop Adapter                | Windows   |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| type         | Network adapter           | ethernet                                            |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| state        | State of network          | up                                                  |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| mtu          | Maximum transmission unit | 1500                                                |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| mac          | MAC Address               | 08:00:27:C0:14:A5                                   |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| tx_packets   | Transmitted packets       | 30279                                               |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| rx_packets   | Received packets          | 12754                                               |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| tx_bytes     | Transmitted bytes         | 10034626                                            |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| rx_bytes     | Received bytes            | 1111175                                             |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| tx_errors    | Transmitted with error    | 0                                                   |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| rx_errors    | Received with error       | 0                                                   |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| tx_dropped   | Transmitted and discarded | 0                                                   |
+--------------+---------------------------+-----------------------------------------------------+-----------+
| rx_dropped   | Received and discarded    | 0                                                   |
+--------------+---------------------------+-----------------------------------------------------+-----------+


+--------------+---------------------------------+-----------------------------------------------------+-----------+
| Field        | Description                     | Example                                             | Available |
+==============+=================================+=====================================================+===========+
| id           | Referenced id from sys_netiface | 468455719                                           |
+--------------+---------------------------------+-----------------------------------------------------+-----------+
| scan_id      | Scan identifier                 | 160615720                                           |
+--------------+---------------------------------+-----------------------------------------------------+-----------+
| proto        | Protocol name                   | ipv4                                                |
+--------------+---------------------------------+-----------------------------------------------------+-----------+
| address      | IP(v4/v6) address               | 192.168.1.87                                        |
+--------------+---------------------------------+-----------------------------------------------------+-----------+
| netmask      | Mask address                    | 255.255.255.0                                       |
+--------------+---------------------------------+-----------------------------------------------------+-----------+
| broadcast    | Broadcast address               | 192.168.1.255                                       |
+--------------+---------------------------------+-----------------------------------------------------+-----------+

+--------------+---------------------------------+-----------------------------------------------------+-----------+
| Field        | Description                     | Example                                             | Available |
+==============+=================================+=====================================================+-----------+
| id           | Referenced id from sys_netiface | 1                                                   |
+--------------+---------------------------------+-----------------------------------------------------+
| scan_id      | Scan identifier                 | 160615720                                           |
+--------------+---------------------------------+-----------------------------------------------------+
| iface        | Network adapter name            | eth0                                                |
+--------------+---------------------------------+-----------------------------------------------------+
| type         | Protocol name                   | Ubuntu                                              |
+--------------+---------------------------------+-----------------------------------------------------+
| gateway      | Gateway address                 | 192.168.1.1                                         |
+--------------+---------------------------------+-----------------------------------------------------+
| dhcp         | dhcp configuration              | enabled                                             |
+--------------+---------------------------------+-----------------------------------------------------+



- `Packages`

 The currently packages inventory of each Wazuh agent. On Linux systems, retrieved packages can be `deb` or `rpm` types.

 - `Ports`

 List of the opened ports of a system.

 - `Processes`

 List of the current processes running in a system host.

Compatibility matrix
---------------------

The following table shows ...



How its works
-------------



Use case: Visualize system inventory in the Wazuh App
-----------------------------------------------------



.. thumbnail:: ../../images/manual/syscollector-"scan".png
    :title: Syscollector scan
    :align: center
    :width: 100%
